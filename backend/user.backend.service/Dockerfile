#Imagen base para compilar
FROM mcr.microsoft.com/dotnet/sdk:6.0 as build

#Copiar el c贸digo fuente
WORKDIR /app
COPY . .
RUN dotnet restore
RUN dotnet publish -o /app/published-app

#Imagen base para ejecuci贸n
FROM mcr.microsoft.com/dotnet/aspnet:6.0 as runtime
WORKDIR /app
COPY --from=build /app/published-app /app

#Definir las variables
ENV SqlServerSettings__ConnectionString=Server=.;Database=BD_NET_BACKEND;User Id=sa;Password=PasswordO1.
ENV MongoDatabaseSettings__ConnectionString=mongodb://root:rootpassword@localhost:27017/admin

#Definir los puertos a exponer
# EXPOSE 5000
# EXPOSE 5001

#Indicar la ejecuci贸n de la aplicaci贸n
ENTRYPOINT [ "dotnet", "/app/user.backend.api.dll" ]

#docker build -t user_microservice:1.0 . 